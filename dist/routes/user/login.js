'use strict';

var express = require('express');
var router = express.Router();
var UserModel = require('../../model/UserModel');

var _require = require('../../utils/constant'),
    Sendformat = _require.Sendformat;

var loginCheck = function loginCheck(query, d) {
    var user = query.user;
    var password = query.password;
    if (!d || user != d.user || password != d.password) {
        return { code: 1, desc: '用户名或密码错误' };
    } else {
        return { code: 0, desc: '成功' };
    }
};

router.get('/', function (req, res, next) {
    var cookies = req.cookies;
    var user = req.query.user;
    var password = req.query.password;
    UserModel.findUser({
        user: user
    }).then(function (result) {
        var d = result[0];
        var obj = loginCheck(req.query, d);
        if (obj.code == 0) {
            var ck = new Date().getTime() + '&' + user;
            res.cookie("cookie", ck, { maxAge: 60 * 1000 });
            res.send({ code: obj.code, desc: obj.desc, data: [] });
        } else {
            res.send({ code: obj.code, desc: obj.desc, data: [] });
        }
    });
});

module.exports = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yb3V0ZXMvdXNlci9sb2dpbi5qcyJdLCJuYW1lcyI6WyJleHByZXNzIiwicmVxdWlyZSIsInJvdXRlciIsIlJvdXRlciIsIlVzZXJNb2RlbCIsIlNlbmRmb3JtYXQiLCJsb2dpbkNoZWNrIiwicXVlcnkiLCJkIiwidXNlciIsInBhc3N3b3JkIiwiY29kZSIsImRlc2MiLCJnZXQiLCJyZXEiLCJyZXMiLCJuZXh0IiwiY29va2llcyIsImZpbmRVc2VyIiwidGhlbiIsInJlc3VsdCIsIm9iaiIsImNrIiwiRGF0ZSIsImdldFRpbWUiLCJjb29raWUiLCJtYXhBZ2UiLCJzZW5kIiwiZGF0YSIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsVUFBVUMsUUFBUSxTQUFSLENBQWhCO0FBQ0EsSUFBTUMsU0FBU0YsUUFBUUcsTUFBUixFQUFmO0FBQ0EsSUFBTUMsWUFBWUgsUUFBUSx1QkFBUixDQUFsQjs7ZUFDcUJBLFFBQVEsc0JBQVIsQztJQUFkSSxVLFlBQUFBLFU7O0FBRVAsSUFBTUMsYUFBYSxTQUFiQSxVQUFhLENBQUNDLEtBQUQsRUFBUUMsQ0FBUixFQUFhO0FBQzVCLFFBQU1DLE9BQU9GLE1BQU1FLElBQW5CO0FBQ0EsUUFBTUMsV0FBV0gsTUFBTUcsUUFBdkI7QUFDQSxRQUFHLENBQUNGLENBQUQsSUFBTUMsUUFBUUQsRUFBRUMsSUFBaEIsSUFBd0JDLFlBQVlGLEVBQUVFLFFBQXpDLEVBQWtEO0FBQzlDLGVBQU8sRUFBQ0MsTUFBTSxDQUFQLEVBQVVDLE1BQU0sVUFBaEIsRUFBUDtBQUNILEtBRkQsTUFFSztBQUNELGVBQU8sRUFBQ0QsTUFBTSxDQUFQLEVBQVNDLE1BQU0sSUFBZixFQUFQO0FBQ0g7QUFDSixDQVJEOztBQVVBVixPQUFPVyxHQUFQLENBQVcsR0FBWCxFQUFnQixVQUFDQyxHQUFELEVBQU1DLEdBQU4sRUFBV0MsSUFBWCxFQUFvQjtBQUNoQyxRQUFNQyxVQUFVSCxJQUFJRyxPQUFwQjtBQUNBLFFBQU1SLE9BQU9LLElBQUlQLEtBQUosQ0FBVUUsSUFBdkI7QUFDQSxRQUFNQyxXQUFXSSxJQUFJUCxLQUFKLENBQVVHLFFBQTNCO0FBQ0FOLGNBQVVjLFFBQVYsQ0FBbUI7QUFDZlQsY0FBTUE7QUFEUyxLQUFuQixFQUVHVSxJQUZILENBRVEsVUFBVUMsTUFBVixFQUFrQjtBQUN0QixZQUFNWixJQUFJWSxPQUFPLENBQVAsQ0FBVjtBQUNBLFlBQUlDLE1BQU1mLFdBQVdRLElBQUlQLEtBQWYsRUFBc0JDLENBQXRCLENBQVY7QUFDQSxZQUFJYSxJQUFJVixJQUFKLElBQVksQ0FBaEIsRUFBbUI7QUFDZixnQkFBSVcsS0FBUSxJQUFJQyxJQUFKLEdBQVdDLE9BQVgsRUFBUixTQUFnQ2YsSUFBcEM7QUFDQU0sZ0JBQUlVLE1BQUosQ0FBVyxRQUFYLEVBQXFCSCxFQUFyQixFQUF5QixFQUFDSSxRQUFRLEtBQUssSUFBZCxFQUF6QjtBQUNBWCxnQkFBSVksSUFBSixDQUFTLEVBQUNoQixNQUFNVSxJQUFJVixJQUFYLEVBQWlCQyxNQUFNUyxJQUFJVCxJQUEzQixFQUFpQ2dCLE1BQUssRUFBdEMsRUFBVDtBQUNILFNBSkQsTUFJTztBQUNIYixnQkFBSVksSUFBSixDQUFTLEVBQUNoQixNQUFNVSxJQUFJVixJQUFYLEVBQWlCQyxNQUFNUyxJQUFJVCxJQUEzQixFQUFpQ2dCLE1BQU0sRUFBdkMsRUFBVDtBQUNIO0FBQ0osS0FaRDtBQWNILENBbEJEOztBQW9CQUMsT0FBT0MsT0FBUCxHQUFpQjVCLE1BQWpCIiwiZmlsZSI6ImxvZ2luLmpzIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5jb25zdCBVc2VyTW9kZWwgPSByZXF1aXJlKCcuLi8uLi9tb2RlbC9Vc2VyTW9kZWwnKVxuY29uc3Qge1NlbmRmb3JtYXR9ID0gcmVxdWlyZSgnLi4vLi4vdXRpbHMvY29uc3RhbnQnKVxuXG5jb25zdCBsb2dpbkNoZWNrID0gKHF1ZXJ5LCBkKT0+IHtcbiAgICBjb25zdCB1c2VyID0gcXVlcnkudXNlcjtcbiAgICBjb25zdCBwYXNzd29yZCA9IHF1ZXJ5LnBhc3N3b3JkO1xuICAgIGlmKCFkIHx8IHVzZXIgIT0gZC51c2VyIHx8IHBhc3N3b3JkICE9IGQucGFzc3dvcmQpe1xuICAgICAgICByZXR1cm4ge2NvZGU6IDEsIGRlc2M6ICfnlKjmiLflkI3miJblr4bnoIHplJnor68nfVxuICAgIH1lbHNle1xuICAgICAgICByZXR1cm4ge2NvZGU6IDAsZGVzYzogJ+aIkOWKnyd9XG4gICAgfVxufVxuXG5yb3V0ZXIuZ2V0KCcvJywgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgY29uc3QgY29va2llcyA9IHJlcS5jb29raWVzO1xuICAgIGNvbnN0IHVzZXIgPSByZXEucXVlcnkudXNlcjtcbiAgICBjb25zdCBwYXNzd29yZCA9IHJlcS5xdWVyeS5wYXNzd29yZDtcbiAgICBVc2VyTW9kZWwuZmluZFVzZXIoe1xuICAgICAgICB1c2VyOiB1c2VyXG4gICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XG4gICAgICAgIGNvbnN0IGQgPSByZXN1bHRbMF07XG4gICAgICAgIGxldCBvYmogPSBsb2dpbkNoZWNrKHJlcS5xdWVyeSwgZCk7XG4gICAgICAgIGlmIChvYmouY29kZSA9PSAwKSB7XG4gICAgICAgICAgICBsZXQgY2sgPSBgJHtuZXcgRGF0ZSgpLmdldFRpbWUoKX0mJHt1c2VyfWA7XG4gICAgICAgICAgICByZXMuY29va2llKFwiY29va2llXCIsIGNrLCB7bWF4QWdlOiA2MCAqIDEwMDB9KTtcbiAgICAgICAgICAgIHJlcy5zZW5kKHtjb2RlOiBvYmouY29kZSwgZGVzYzogb2JqLmRlc2MsIGRhdGE6W119KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlcy5zZW5kKHtjb2RlOiBvYmouY29kZSwgZGVzYzogb2JqLmRlc2MsIGRhdGE6IFtdfSk7XG4gICAgICAgIH1cbiAgICB9KVxuXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSByb3V0ZXI7XG4iXX0=