'use strict';

var fs = require('fs');
var request = require('request');
var path = require('path');

/**
 * 抓取图片
 * @param url
 * @constructor
 */
function GetImg(url) {
    return new Promise(function (resolve, reject) {
        request.head(url, function (err, res, body) {
            if (err) {
                console.log(err);
            } else {
                var filename = new Date().getTime() + url.substr(-4, 4);
                var dir = path.join(__dirname, './../public/img/' + filename);
                request(url).pipe(fs.createWriteStream(dir));
                console.log('拉取成功');
                resolve(filename);
            }
        });
    });
}

/**
 * 
 */
function isExists(path) {
    fs.exists(path, function (exists) {
        if (exists) {
            return true;
            console.log("文件存在");
        }
        if (!exists) {
            return false;
            console.log("文件不存在");
        }
    });
}

module.exports = {
    GetImg: GetImg
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy91dGlscy5qcyJdLCJuYW1lcyI6WyJmcyIsInJlcXVpcmUiLCJyZXF1ZXN0IiwicGF0aCIsIkdldEltZyIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaGVhZCIsImVyciIsInJlcyIsImJvZHkiLCJjb25zb2xlIiwibG9nIiwiZmlsZW5hbWUiLCJEYXRlIiwiZ2V0VGltZSIsInN1YnN0ciIsImRpciIsImpvaW4iLCJfX2Rpcm5hbWUiLCJwaXBlIiwiY3JlYXRlV3JpdGVTdHJlYW0iLCJpc0V4aXN0cyIsImV4aXN0cyIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBTUEsS0FBS0MsUUFBUSxJQUFSLENBQVg7QUFDQSxJQUFNQyxVQUFVRCxRQUFRLFNBQVIsQ0FBaEI7QUFDQSxJQUFNRSxPQUFPRixRQUFRLE1BQVIsQ0FBYjs7QUFFQTs7Ozs7QUFLQSxTQUFTRyxNQUFULENBQWdCQyxHQUFoQixFQUFxQjtBQUNqQixXQUFPLElBQUlDLE9BQUosQ0FBWSxVQUFDQyxPQUFELEVBQVVDLE1BQVYsRUFBcUI7QUFDcENOLGdCQUFRTyxJQUFSLENBQWFKLEdBQWIsRUFBa0IsVUFBQ0ssR0FBRCxFQUFNQyxHQUFOLEVBQVdDLElBQVgsRUFBb0I7QUFDbEMsZ0JBQUlGLEdBQUosRUFBUztBQUNMRyx3QkFBUUMsR0FBUixDQUFZSixHQUFaO0FBQ0gsYUFGRCxNQUVPO0FBQ0gsb0JBQU1LLFdBQVcsSUFBSUMsSUFBSixHQUFXQyxPQUFYLEtBQXVCWixJQUFJYSxNQUFKLENBQVcsQ0FBQyxDQUFaLEVBQWUsQ0FBZixDQUF4QztBQUNBLG9CQUFNQyxNQUFNaEIsS0FBS2lCLElBQUwsQ0FBVUMsU0FBVixFQUFxQixxQkFBcUJOLFFBQTFDLENBQVo7QUFDQWIsd0JBQVFHLEdBQVIsRUFBYWlCLElBQWIsQ0FBa0J0QixHQUFHdUIsaUJBQUgsQ0FBcUJKLEdBQXJCLENBQWxCO0FBQ0FOLHdCQUFRQyxHQUFSLENBQVksTUFBWjtBQUNBUCx3QkFBUVEsUUFBUjtBQUNIO0FBQ0osU0FWRDtBQVdILEtBWk0sQ0FBUDtBQWFIOztBQUVEOzs7QUFHQSxTQUFTUyxRQUFULENBQWtCckIsSUFBbEIsRUFBd0I7QUFDcEJILE9BQUd5QixNQUFILENBQVV0QixJQUFWLEVBQWdCLFVBQVVzQixNQUFWLEVBQWtCO0FBQzlCLFlBQUlBLE1BQUosRUFBWTtBQUNSLG1CQUFPLElBQVA7QUFDQVosb0JBQVFDLEdBQVIsQ0FBWSxNQUFaO0FBQ0g7QUFDRCxZQUFJLENBQUNXLE1BQUwsRUFBYTtBQUNULG1CQUFPLEtBQVA7QUFDQVosb0JBQVFDLEdBQVIsQ0FBWSxPQUFaO0FBQ0g7QUFDSixLQVREO0FBVUg7O0FBR0RZLE9BQU9DLE9BQVAsR0FBaUI7QUFDYnZCLFlBQVFBO0FBREssQ0FBakIiLCJmaWxlIjoidXRpbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCByZXF1ZXN0ID0gcmVxdWlyZSgncmVxdWVzdCcpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcblxuLyoqXG4gKiDmipPlj5blm77niYdcbiAqIEBwYXJhbSB1cmxcbiAqIEBjb25zdHJ1Y3RvclxuICovXG5mdW5jdGlvbiBHZXRJbWcodXJsKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgcmVxdWVzdC5oZWFkKHVybCwgKGVyciwgcmVzLCBib2R5KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIHVybC5zdWJzdHIoLTQsIDQpXG4gICAgICAgICAgICAgICAgY29uc3QgZGlyID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4vLi4vcHVibGljL2ltZy8nICsgZmlsZW5hbWUpO1xuICAgICAgICAgICAgICAgIHJlcXVlc3QodXJsKS5waXBlKGZzLmNyZWF0ZVdyaXRlU3RyZWFtKGRpcikpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfmi4nlj5bmiJDlip8nKTtcbiAgICAgICAgICAgICAgICByZXNvbHZlKGZpbGVuYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSlcbn1cblxuLyoqXG4gKiBcbiAqL1xuZnVuY3Rpb24gaXNFeGlzdHMocGF0aCkge1xuICAgIGZzLmV4aXN0cyhwYXRoLCBmdW5jdGlvbiAoZXhpc3RzKSB7XG4gICAgICAgIGlmIChleGlzdHMpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLmlofku7blrZjlnKhcIilcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWV4aXN0cykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCLmlofku7bkuI3lrZjlnKhcIilcbiAgICAgICAgfVxuICAgIH0pXG59XG5cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gICAgR2V0SW1nOiBHZXRJbWdcbn0iXX0=